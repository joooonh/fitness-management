<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.UserMapper">
	
	<select id="getUserList" parameterType="map" resultType="UserListAttDto">
		select
				user_no 				    as userNo,
				user_id 				    as userId,
				user_name			    	as userName,
				user_gender					as userGender,
				user_birthday 				as userBirthday,
				user_email					as userEmail,
				user_tel				    as userTel,
				user_created_date		    as CreatedDate,
				user_updated_date 			as UpdatedDate,
				user_start_time				as StartTime,
				user_end_time	    		as EndTime,
				class_attendance_date		as classAttDate,
				program_no					as programNo,
				program_name				as programName
			
		from	(
			select
				row_number() over(order by A.user_no desc) row_numbers,
				A.user_no,
				A.user_id,
				A.user_name,
				A.user_gender,
				A.user_birthday,
				A.user_email,
				A.user_tel,
				A.user_created_date,
				A.user_updated_date,
				B.user_start_time,
				B.user_end_time,
				C.class_attendance_date,
				C.program_no,
				D.program_name		
			from 
				users A, user_attendances B, user_class_attendances C , fitness_programs D
			where
				A.user_no = B.user_no
				and A.user_no = B.user_no
				and C.program_no = D.program_no
				
			)
			
			where
				row_numbers between #{begin} and #{end}
	</select>
	
	<select id="getTotalRows" resultType="int">
		select
			count(*)
		from
			users
		where
			user_deleted = 'N'
	</select>
	
	<select id="getPrograms" parameterType="map" resultType="FitnessProgramCategory">
		select
    		fitness_program_category_no as categoryNo,
    		fitness_program_category_name as categoryName
		from
   			 fitness_program_category
	</select>
</mapper>